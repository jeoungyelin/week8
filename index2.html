<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>êµìˆ˜ë‹˜ ëª°ë˜ í”„ë ˆì²¼ ë¨¹ê¸° ê²Œì„</title>
    
    <style>
        /* ------------------------------------- */
        /* A. ì „ì²´ ì´ˆê¸° ì„¤ì • ë° ë°°ê²½ ì´ë¯¸ì§€ ì„¤ì • */
        /* ------------------------------------- */
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; }

        #main-screen, #game-screen, #help-overlay, .end-screen { 
            width: 100%; height: 100%; position: absolute; top: 0; left: 0; 
            background-size: cover; background-position: center; 
        }
        #game-screen, #help-overlay, .end-screen { display: none; }
        .end-screen { z-index: 500; display: flex; justify-content: center; align-items: center; flex-direction: column; background-color: rgba(0, 0, 0, 0.8); }
        .end-screen h1 { color: white; font-size: 48px; }

        /* B. í™ˆ í™”ë©´ ìŠ¤íƒ€ì¼ */
        #main-screen { background-image: url('Frame 2087326991.png'); z-index: 400; }
        
        /* 1. í™ˆ í™”ë©´ ì¸ë¬¼ ë° ë§í’ì„  ìŠ¤íƒ€ì¼ */
        #main-character-img { 
            width: 850px; height: 950px; position: absolute; 
            bottom: -100%; left: 100px; 
            transform: translate(0, 0); 
            background-image: url('image 110492.png'); background-size: contain;
            transition: bottom 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55); 
            z-index: 405;
        }
        #main-character-bubble { 
            width: 250px; height: 180px; position: absolute; 
            top: 20%; left: 10%; background-image: url('hey.png'); 
            background-size: contain; opacity: 0; transition: opacity 0.3s; z-index: 406;
        }

        /* 2. ë²„íŠ¼ ê³µí†µ ë° ê°œë³„ ìœ„ì¹˜ */
        button {
            background: none; border: none; cursor: pointer; padding: 0; position: absolute;
            top: auto; left: auto; z-index: 410;
        }
        button img { display: block; width: 100%; height: auto; }
        #button-1 { width: 250px; bottom: 100px; right: 520px; } 
        #button-2 { width: 250px; bottom: 100px; right: 220px; } 
        #button-3 { width: 100px; top: 40px; right: 40px; }

        /* C. ê²Œì„ ì‹œì‘ í™”ë©´ ìš”ì†Œ */
        #game-screen { background-image: url('Frame 2087326990.png'); z-index: 300; }

        /* 1. êµìˆ˜ë‹˜ ì „ì‹  ë° ì–¼êµ´/ëˆˆì•Œ */
        #professor { 
            width: 480px; height: 480px; position: absolute; top: 150px; left: 50%; 
            background-image: url('êµìˆ˜ë‹˜_ì´ë¯¸ì§€.png'); background-size: contain; z-index: 305; 
            transform: translateX(-50%);
        }
        #professor-face { /* ğŸš¨ ì–¼êµ´ í™•ëŒ€ìš© ë°”íƒ• ğŸš¨ */
            width: 205px; height: 205px; position: absolute; top: 142px; left: 46.2%; 
            background-image: url('profe face.png'); /* ğŸš¨ ëˆˆ ë¶€ë¶„ì´ íˆ¬ëª…í•œ ì´ë¯¸ì§€ ğŸš¨ */
            background-size: contain; z-index: 307; opacity: 0; 
            transform: translateX(-50%) scale(1.0); 
            transition: transform 0.3s ease-out, left 0.3s ease-out, opacity 0.3s ease-out;
            position: relative; /* ëˆˆì•Œ ë°°ì¹˜ë¥¼ ìœ„í•œ ê¸°ì¤€ì  */
        }
        #professor-eye { /* ğŸš¨ ëˆˆì•Œ (ì–¼êµ´ ë’¤ì— ìœ„ì¹˜) ğŸš¨ */
            width: 50px; height: 50px; position: absolute; top: 60px; left: 50%; 
            background-image: url('Group 2085666296.png'); 
            background-size: contain; z-index: 306; opacity: 0; 
            transform: translateX(-50%) scale(1.0);
            transition: transform 0.3s ease-in-out, left 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }
        
        /* 2. í”Œë ˆì´ì–´ */
        #player { 
            width: 320px; height: 480px; position: absolute; bottom: -50px; left: 50%; 
            background-image: url('back student.png'); background-size: contain; z-index: 309; 
            transform: translateX(-50%); transition: left 0.1s linear; 
        }

        /* 3. ìƒíƒœ ì°½ ë° ê²½ê³  */
        .status-bar { position: absolute; z-index: 312; background-size: contain; background-repeat: no-repeat; }
        #status-timer { top: 30px; left: 30px; width: 600px; height: 140px; background-image: url('Group 2085666292.png'); position: relative; overflow: hidden; padding: 0; }
        #timer-bar { width: 100%; height: 100%; background-color: #FF00BB; transition: width 0.1s linear; }

        #status-score { top: 30px; right: 30px; width: 200px; height: 70px; background-image: url('í”„ë ˆì²¼_íšë“_ì°½.png'); z-index: 313; display: flex; justify-content: center; align-items: center; color: white; font-size: 24px; }
        #score-display { color: white; }

        /* ê²½ê³ ì°½ (ê²½ê³  ì¹´ë“œ 3ê°œ) */
        #status-alert { bottom: 30px; right: 30px; width: 500px; height: 180px; background-image: url('Group 2085666291.png'); display: flex; align-items: flex-end; justify-content: flex-start; padding: 10px; }
        #alert-wrapper { display: flex; align-items: flex-end; }
        .alert-item { width: 120px; height: 120px; background-image: url('warning_card.png'); background-size: contain; opacity: 0; transition: opacity 0.3s; margin-right: 10px; }
        
        /* ğŸš¨ ë§í’ì„  ê³µê²© ìš”ì†Œ (2-5) ğŸš¨ */
        #attack-bubble {
            position: absolute; width: 150px; height: 150px; 
            background-image: url('ë§í’ì„ _ê³µê²©.png'); background-size: contain;
            opacity: 0; transform: translateY(0); transition: opacity 0.1s, transform 0.5s linear; 
            z-index: 311;
        }

        /* E. ê²Œì„ ë°©ë²• ì˜¤ë²„ë ˆì´ ìŠ¤íƒ€ì¼ */
        #help-overlay { display: flex; justify-content: center; align-items: center; z-index: 600; background-color: rgba(0, 0, 0, 0.9); }
        #help-image-container { width: 80%; height: 80%; background-size: contain; background-repeat: no-repeat; background-position: center; position: relative; }
        .help-nav-btn { position: absolute; top: 50%; transform: translateY(-50%); width: 80px; height: 80px; }
        #help-next-button { right: 5%; }
        #help-prev-button { left: 5%; display: none; }
        #help-back-button { position: absolute; top: 20px; left: 20px; width: 100px; z-index: 601; }

    </style>
</head>
<body>
    
    <div id="game-screen">
        
        <div id="status-timer" class="status-bar">
            <div id="timer-bar"></div>
        </div>
        <div id="status-score" class="status-bar">
            <div id="score-display">0 / 30</div>
        </div>
        
        <div id="status-alert" class="status-bar">
            <div id="alert-wrapper">
                <div id="alert-1" class="alert-item"></div>
                <div id="alert-2" class="alert-item"></div>
                <div id="alert-3" class="alert-item"></div>
            </div>
        </div>
        
        <div id="professor"></div>
        <div id="professor-face">
            <div id="professor-eye"></div>
        </div>

        <div id="player"></div>
        
        <div id="attack-bubble"></div>
    </div>
    
    <div id="gameover-screen" class="end-screen">
        <h1>GAME OVER</h1>
        <p id="gameover-reason">ì‹œê°„ ì´ˆê³¼</p>
        <button id="gameover-retry">ë‹¤ì‹œ í•˜ê¸°</button>
    </div>

    <div id="clear-screen" class="end-screen">
        <h1>GAME CLEAR!</h1>
        <button id="clear-retry">ë‹¤ì‹œ í•˜ê¸°</button>
    </div>

    <div id="main-screen">
        
        <div id="main-character-img"></div> 
        <div id="main-character-bubble"></div>
        
        <button id="start-button">
            <img src="Group 2085666287.png" alt="ê²Œì„ ì‹œì‘" data-normal="Group 2085666287.png" data-hover="Group 2085666238.png">
        </button>
        <button id="help-button">
            <img src="Group 2085666288.png" alt="ê²Œì„ ë°©ë²•" data-normal="Group 2085666288.png" data-hover="Group 2085666241.png">
        </button>
        <button id="bgm-button">
            <img src="Group 2085666266.png" alt="BGM ì¼œê¸°/ë„ê¸°" id="bgm-icon" data-normal="Group 2085666265.png" data-off="Group 2085666266.png">
        </button>
    </div>
    
    <div id="help-overlay">
        <div id="help-image-container">
        </div>
        <button id="help-next-button" class="help-nav-btn">
            <img src="next_normal.png" data-normal="next_normal.png" data-hover="next_hover.png">
        </button>
        <button id="help-prev-button" class="help-nav-btn">
            <img src="prev_normal.png" data-normal="prev_normal.png" data-hover="prev_hover.png">
        </button>
        <button id="help-back-button">
            <img src="back_normal.png" data-normal="back_normal.png" data-hover="back_hover.png">
        </button>
    </div>

    <audio id="game-bgm" src="[diINnQEGrY4].mp3" loop></audio>
    <audio id="eat-sound" src="eat_sound.mp3"></audio>

    <script>
        // ğŸš¨ JavaScript ì½”ë“œ ì „ë¬¸ ğŸš¨

        let helpPageIndex = 1; 
        let isBgmPlaying = false;
        
        // ê²Œì„ ë³€ìˆ˜ (2ë²ˆ íŒŒì¼ìš©)
        let gameScreen, player, professorFace, professorEye;
        let scoreDisplay;
        let playerX = 0;
        const MOVE_SPEED = 15; 
        let snackCount = 0; 
        const PRESSES_PER_STAGE = 10; 
        const TOTAL_SNACKS = 3; 
        const MAX_PRESSES = 30; 
        let alertCount = 0; 
        const MAX_ALERT = 3; 
        let isGameOver = false;
        let isGlobalAlert = false; 
        let alertElements;
        let eatSound;
        
        // ğŸš¨ ê³µê²© ë§í’ì„  ëœë¤ ìœ„ì¹˜/ì´ë™ ì†ë„ ğŸš¨
        const ATTACK_BUBBLE_IMAGES = ['attack_bubble1.png', 'attack_bubble2.png'];
        const BUBBLE_SPEED = 10;
        
        // ğŸš¨ íƒ€ì´ë¨¸ ë° ì´ë²¤íŠ¸ ì¸í„°ë²Œ ID ğŸš¨
        let gameTimer, globalAlertInterval, attackInterval, eyeMovementInterval;


        // --- 1. ìœ í‹¸ë¦¬í‹° ë° ìƒíƒœ í•¨ìˆ˜ ---

        function setupHoverEffect(buttonElement) {
            const imageElement = buttonElement.querySelector('img');
            if (!imageElement) return;
            imageElement.addEventListener('mouseover', () => { 
                imageElement.src = imageElement.dataset.hover || imageElement.dataset.off || imageElement.dataset.normal; 
            });
            imageElement.addEventListener('mouseout', () => { imageElement.src = imageElement.dataset.normal; });
        }

        function setHelpPage(index) {
            const totalPages = 3; 
            if (index < 1 || index > totalPages) return;
            
            helpPageIndex = index;
            const container = document.getElementById('help-image-container');
            container.style.backgroundImage = `url('help_img_${index}.png')`; 
            
            document.getElementById('help-next-button').style.display = (index < totalPages) ? 'block' : 'none';
            document.getElementById('help-prev-button').style.display = (index > 1) ? 'block' : 'none';
        }

        function triggerGameOver(reason) {
            if (isGameOver) return;
            isGameOver = true;
            
            // ëª¨ë“  ê²Œì„ ë£¨í”„ ì •ì§€
            clearInterval(gameTimer);
            clearInterval(globalAlertInterval);
            clearInterval(attackInterval);
            clearInterval(eyeMovementInterval);

            // BGM ì •ì§€
            const gameBgm = document.getElementById('game-bgm');
            gameBgm.pause();
            
            // í™”ë©´ ì „í™˜
            document.getElementById('gameover-screen').style.display = 'flex';
            document.getElementById('gameover-reason').textContent = reason;
            document.getElementById('game-screen').style.display = 'none';
        }
        
        function triggerGameClear() {
            if (isGameOver) return;
            isGameOver = true;
            
            // ëª¨ë“  ê²Œì„ ë£¨í”„ ì •ì§€
            clearInterval(gameTimer);
            clearInterval(globalAlertInterval);
            clearInterval(attackInterval);
            clearInterval(eyeMovementInterval);

            // BGM ì •ì§€
            const gameBgm = document.getElementById('game-bgm');
            gameBgm.pause();
            
            // í™”ë©´ ì „í™˜
            document.getElementById('clear-screen').style.display = 'flex';
            document.getElementById('game-screen').style.display = 'none';
        }


        // --- 2. êµìˆ˜ë‹˜ ê°ì‹œ ëª¨ë“œ ë° ëˆˆì•Œ ì›€ì§ì„ ---
        
        function startEyeMovement() {
            if (isGameOver || !isGlobalAlert) return;
            
            let targetLeft = 0;
            // 1. ì¢Œìš° ë°©í–¥ì„ ëœë¤í•˜ê²Œ ì„ íƒ (-1, 1)
            const isWatchingLeft = Math.random() < 0.5;
            
            // 2. íƒ€ê²Ÿ ìœ„ì¹˜ ê³„ì‚° (20px ì¢Œìš° ì´ë™)
            targetLeft = isWatchingLeft ? -20 : 20;
            
            // 3. ëˆˆì•Œ ìœ„ì¹˜ ì—…ë°ì´íŠ¸ (ì–¼êµ´ í™•ëŒ€ì™€ ì¢Œìš° ì´ë™ ë™ì‹œ ì ìš©)
            professorEye.style.transform = `translateX(-50%) scale(2.0) translateX(${targetLeft}px)`;

            // ğŸš¨ 4ì´ˆ ë™ì•ˆ ëˆˆì•Œì´ ê³ ì •ëœ ìƒíƒœì—ì„œ ëŒ€ê¸° ğŸš¨
            setTimeout(() => {
                if (isGameOver) return;
                
                // ëˆˆì•Œ ìœ„ì¹˜ ë³µêµ¬ ë° ë‹¤ìŒ ì›€ì§ì„ ì¤€ë¹„ (0pxë¡œ ì´ë™)
                professorEye.style.transform = `translateX(-50%) scale(2.0) translateX(0px)`;
            }, 2000); // 2ì´ˆ í›„ ì ì‹œ ì¤‘ì•™ìœ¼ë¡œ ëŒì•„ì˜´
        }

        function startGlobalAlertCycle() {
            if (isGameOver) return;
            
            const INITIAL_FACE_LEFT_PERCENT = 50; // CSS left: 50%ë¥¼ ì‚¬ìš© (êµìˆ˜ë‹˜ ì „ì‹  ê¸°ì¤€)
            const MAX_SHIFT_PX = 10; 
            
            // 1. ì „ì²´ ì‹œì•¼ ëª¨ë“œ ì‹œì‘
            isGlobalAlert = true;
            
            // ğŸš¨ ëœë¤ ì¢Œìš° ë–¨ë¦¼ ìœ„ì¹˜ ì¡°ì • (-5px ~ +5px) ğŸš¨
            const randomShift = (Math.random() * MAX_SHIFT_PX) - (MAX_SHIFT_PX / 2); 
            
            // ğŸš¨ ì–¼êµ´ê³¼ ëˆˆì•Œ ë™ì‹œ í™•ëŒ€ ë° ì¢Œìš° ë–¨ë¦¼ ì ìš© ğŸš¨
            professorFace.style.opacity = 1;
            professorEye.style.opacity = 1;
            professorFace.style.transform = `translateX(-50%) scale(2.0)`;
            professorFace.style.left = `calc(${INITIAL_FACE_LEFT_PERCENT}% + ${randomShift}px)`;
            professorEye.style.left = `calc(50% + ${randomShift}px)`; 
            professorEye.style.transform = `translateX(-50%) scale(2.0)`;
            
            // 2. ëˆˆì•Œ ì¢Œìš° ì›€ì§ì„ ì‹œì‘
            eyeMovementInterval = setInterval(startEyeMovement, 1000); 
            
            // 3. 4ì´ˆ í›„ ëª¨ë“œ ì¢…ë£Œ ë° ë³µêµ¬
            setTimeout(() => {
                if (isGameOver) return;
                clearInterval(eyeMovementInterval); 
                
                isGlobalAlert = false;
                professorFace.style.transform = `translateX(-50%) scale(1.0)`;
                professorFace.style.left = `${INITIAL_FACE_LEFT_PERCENT}%`; 
                professorFace.style.opacity = 0; 
                
                professorEye.style.transform = `translateX(-50%) scale(1.0)`; 
                professorEye.style.left = `50%`; 
                professorEye.style.opacity = 0; 

                // 4. ë‹¤ìŒ ì´ë²¤íŠ¸ê¹Œì§€ ëœë¤ ì‹œê°„ ëŒ€ê¸° í›„ ì¬í˜¸ì¶œ (5ì´ˆ ~ 10ì´ˆ)
                const nextDelay = 5000 + Math.random() * 5000; 
                setTimeout(startGlobalAlertCycle, nextDelay);

            }, 4000); // 4ì´ˆ ë™ì•ˆ ìœ ì§€
        }

        // --- 3. ë§í’ì„  ê³µê²© ë° ì¶©ëŒ ë¡œì§ ---
        function startAttackCycle() {
            if (isGameOver) return;
            
            const attackBubble = document.getElementById('attack-bubble');
            
            // 1. ëœë¤ ì´ë¯¸ì§€ ë° ìœ„ì¹˜ ì„¤ì •
            const randomIndex = Math.floor(Math.random() * ATTACK_BUBBLE_IMAGES.length);
            attackBubble.style.backgroundImage = `url('${ATTACK_BUBBLE_IMAGES[randomIndex]}')`;
            
            const playerRect = player.getBoundingClientRect();
            const screenRect = gameScreen.getBoundingClientRect();
            
            // ê³µê²© ì‹œì‘ ìœ„ì¹˜ (í™”ë©´ ìƒë‹¨)
            const startX = (playerRect.left + playerRect.width / 2) - screenRect.left + (Math.random() * 100) - 50; 
            const startY = -50; 
            
            attackBubble.style.left = `${startX}px`;
            attackBubble.style.top = `${startY}px`;
            attackBubble.style.opacity = 1;

            // 2. í•˜ê°• ì• ë‹ˆë©”ì´ì…˜
            let currentY = startY;
            const dropTimer = setInterval(() => {
                if (isGameOver) { clearInterval(dropTimer); return; }
                currentY += BUBBLE_SPEED;
                attackBubble.style.top = `${currentY}px`;
                
                const bubbleRect = attackBubble.getBoundingClientRect();
                
                // 3. ğŸš¨ í”Œë ˆì´ì–´ì™€ ì¶©ëŒ (ê°„ë‹¨í•œ ì‚¬ê°í˜• ì¶©ëŒ) ğŸš¨
                const isColliding = (
                    bubbleRect.left < playerRect.right &&
                    bubbleRect.right > playerRect.left &&
                    bubbleRect.top < playerRect.bottom &&
                    bubbleRect.bottom > playerRect.top
                );

                if (isColliding) {
                    clearInterval(dropTimer);
                    attackBubble.style.opacity = 0;
                    alertCount++;
                    
                    // ğŸš¨ ê²½ê³  ì´ë¯¸ì§€ ìŒ“ê¸° ğŸš¨
                    if (alertCount <= MAX_ALERT) {
                        alertElements[alertCount - 1].style.opacity = 1;
                    }

                    if (alertCount >= MAX_ALERT) {
                        triggerGameOver("ê²½ê³  3íšŒ ëˆ„ì !");
                    }
                } else if (currentY > screenRect.bottom) {
                    clearInterval(dropTimer); 
                    attackBubble.style.opacity = 0;
                }

            }, 50);

            // ë‹¤ìŒ ê³µê²©ê¹Œì§€ ëœë¤ ì‹œê°„ ëŒ€ê¸° í›„ ì¬í˜¸ì¶œ (2ì´ˆ ~ 5ì´ˆ)
            const nextAttackDelay = 2000 + Math.random() * 3000;
            setTimeout(startAttackCycle, nextAttackDelay);
        }

        // --- 4. í•™ìƒ ìºë¦­í„° ì´ë™ ë° ì„­ì·¨ ë¡œì§ ---
        function setupPlayerMovement() {
            document.addEventListener('keydown', (event) => {
                if (isGameOver) return;
                let direction = 0;
                const eatSound = document.getElementById('eat-sound');

                // ğŸš¨ ë£°: ì „ì²´ ì‹œì•¼ ëª¨ë“œì—ì„œ í‚¤ë¥¼ ëˆ„ë¥´ë©´ ì¦‰ì‹œ ê²Œì„ ì˜¤ë²„! ğŸš¨
                if (isGlobalAlert) {
                     // ìŠ¤í˜ì´ìŠ¤ë°”ë¥¼ ëˆ„ë¥´ê±°ë‚˜, ì¢Œìš° ë°©í–¥í‚¤/A/D í‚¤ë¥¼ ëˆ„ë¥¼ ê²½ìš°
                    if (event.key === ' ' || event.key === 'ArrowLeft' || event.key === 'ArrowRight' || event.key === 'a' || event.key === 'd') {
                        triggerGameOver("êµìˆ˜ë‹˜ì´ ë…¸ë ¤ë³¼ ë•Œ ì›€ì§ì´ê±°ë‚˜ ë¨¹ìœ¼ë ¤ í–ˆìŠµë‹ˆë‹¤!");
                        return;
                    }
                }

                if (event.key === ' ') { 
                    event.preventDefault(); 
                    
                    if (snackCount >= MAX_PRESSES) { triggerGameClear(); return; }
                    
                    snackCount++;
                    eatSound.currentTime = 0; 
                    eatSound.play().catch(e => console.log('ì†Œë¦¬ ì¬ìƒ ì‹¤íŒ¨')); // ì„­ì·¨ ì†Œë¦¬ ì¬ìƒ
                    
                    // ì ìˆ˜ ë° íˆ¬ëª…ë„ ë¡œì§
                    const currentSnackIndex = Math.floor(snackCount / PRESSES_PER_STAGE); 
                    const currentStage = snackCount % PRESSES_PER_STAGE; 
                    const opacityValue = (currentStage + 1) / PRESSES_PER_STAGE;
                    
                    document.getElementById('score-display').textContent = `${snackCount} / 30`;

                    if (currentSnackIndex < TOTAL_SNACKS) {
                        // í˜„ì¬ ë¡œì§ì€ ìŠ¤ë‚µ ì´ë¯¸ì§€ íˆ¬ëª…ë„ ëŒ€ì‹  ì ìˆ˜ í…ìŠ¤íŠ¸ë§Œ ì—…ë°ì´íŠ¸í•˜ë„ë¡ ê°„ì†Œí™”ë©ë‹ˆë‹¤.
                    }
                    if (snackCount === MAX_PRESSES) {
                        triggerGameClear();
                    }
                    return; 
                }
                
                // ì¢Œìš° ì´ë™ ë¡œì§ 
                switch(event.key) {
                    case 'ArrowLeft': case 'a': direction = -1; break;
                    case 'ArrowRight': case 'd': direction = 1; break;
                }

                if (direction !== 0) { 
                    let currentLeft = parseFloat(player.style.left) || (gameScreen.offsetWidth / 2 - player.offsetWidth / 2);
                    currentLeft += MOVE_SPEED * direction;
                    
                    // í™”ë©´ ê²½ê³„ ì œí•œ (100px ë§ˆì§„)
                    const playerWidth = player.offsetWidth;
                    const screenWidth = gameScreen.offsetWidth;
                    const minXLimit = 100;
                    const maxXLimit = screenWidth - playerWidth - 100;

                    if (currentLeft < minXLimit) { currentLeft = minXLimit; } 
                    else if (currentLeft > maxXLimit) { currentLeft = maxXLimit; }

                    player.style.left = `${currentLeft}px`;
                    player.style.transform = `translateX(0)`; 
                }
            });
        }


        document.addEventListener('DOMContentLoaded', () => {
            const mainScreen = document.getElementById('main-screen');
            const helpOverlay = document.getElementById('help-overlay');
            const mainCharacter = document.getElementById('main-character-img');
            const mainCharacterBubble = document.getElementById('main-character-bubble');
            const gameBgm = document.getElementById('game-bgm');
            const bgmButton = document.getElementById('bgm-button');
            
            const startBtn = document.getElementById('start-button');
            const helpBtn = document.getElementById('help-button');
            const nextBtn = document.getElementById('help-next-button');
            const prevBtn = document.getElementById('help-prev-button');
            const backBtn = document.getElementById('help-back-button');

            // ğŸš¨ ê²Œì„ ìš”ì†Œ í• ë‹¹ ğŸš¨
            gameScreen = document.getElementById('game-screen');
            player = document.getElementById('player');
            professorFace = document.getElementById('professor-face');
            professorEye = document.getElementById('professor-eye');
            alertElements = [document.getElementById('alert-1'), document.getElementById('alert-2'), document.getElementById('alert-3')];
            eatSound = document.getElementById('eat-sound');

            // 1. ìŠ¤í”„ë§ íŠ€ì–´ì˜¤ë¥´ëŠ” íš¨ê³¼ (ë°”ë‹¥ì— ë‹¿ëŠ” ìœ„ì¹˜)
            setTimeout(() => { mainCharacter.style.bottom = '0%'; }, 100); 
            
            // 2. í˜¸ë²„/BGM/í™”ë©´ ì „í™˜ ì´ë²¤íŠ¸ ì—°ê²°
            setupHoverEffect(startBtn); setupHoverEffect(helpBtn); setupHoverEffect(bgmButton);
            setupHoverEffect(nextBtn); setupHoverEffect(prevBtn); setupHoverEffect(backBtn);
            mainCharacter.addEventListener('mouseover', () => { mainCharacterBubble.style.opacity = 1; });
            mainCharacter.addEventListener('mouseout', () => { mainCharacterBubble.style.opacity = 0; });
            
            bgmButton.addEventListener('click', () => { 
                const bgmIcon = document.getElementById('bgm-icon');
                if (isBgmPlaying) { gameBgm.pause(); isBgmPlaying = false; bgmIcon.src = bgmIcon.dataset.off; } 
                else { gameBgm.currentTime = 3; gameBgm.play().catch(e => console.log('BGM ì¬ìƒ ì‹¤íŒ¨:', e)); isBgmPlaying = true; bgmIcon.src = bgmIcon.dataset.normal; }
            });
            
            // ğŸš¨ í™”ë©´ ì „í™˜ ë° ê²Œì„ ì‹œì‘ ğŸš¨
            startBtn.addEventListener('click', () => {
                mainScreen.style.display = 'none'; 
                gameScreen.style.display = 'block'; 
                
                // BGM ì¬ìƒ (ì‹œì‘ ì‹œ)
                if (!isBgmPlaying) { gameBgm.currentTime = 3; gameBgm.play().catch(e => console.log('BGM ì¬ìƒ ì‹¤íŒ¨')); isBgmPlaying = true; }
                
                // ì´ˆê¸°í™”
                isGameOver = false; snackCount = 0; alertCount = 0;
                alertElements.forEach(el => el.style.opacity = 0);
                document.getElementById('score-display').textContent = '0 / 30';

                // ë£¨í”„ ì‹œì‘
                setupPlayerMovement();
                startGlobalAlertCycle();
                startAttackCycle();
            }); 
            
            // ë„ì›€ë§ í˜ì´ì§€ ë¡œì§
            helpBtn.addEventListener('click', () => { mainScreen.style.display = 'none'; helpOverlay.style.display = 'flex'; setHelpPage(1); });
            nextBtn.addEventListener('click', () => { setHelpPage(helpPageIndex + 1); });
            prevBtn.addEventListener('click', () => { setHelpPage(helpPageIndex - 1); });
            backBtn.addEventListener('click', () => { helpOverlay.style.display = 'none'; mainScreen.style.display = 'block'; });
        });
    </script>
</body>
</html>